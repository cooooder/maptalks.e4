/*!
 * maptalks.e4 v1.0.0
 * LICENSE : ISC
 * (c) 2016-2018 maptalks.org
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("maptalks"),require("echarts"),require("echarts-gl")):"function"==typeof define&&define.amd?define(["exports","maptalks","echarts","echarts-gl"],e):e(t.maptalks=t.maptalks||{},t.maptalks,t.echarts,t.echartsGl)}(this,function(t,e,n,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):function(t,e){for(var n=Object.getOwnPropertyNames(e),o=0;o<n.length;o++){var i=n[o],r=Object.getOwnPropertyDescriptor(e,i);r&&r.configurable&&void 0===t[i]&&Object.defineProperty(t,i,r)}}(t,e))}var a=function(t){function e(n,o,r){i(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r));return a._ecOptions=o,a}return r(e,t),e}(e.Layer);a.mergeOptions({container:"front",renderer:"dom",hideOnZooming:!1,hideOnMoving:!1,hideOnRotating:!1}),a.registerRenderer("dom",function(){function t(e){i(this,t),this.layer=e}return t.prototype._resetContainer=function(){var t=this.getMap().getSize();this._container.style.width=t.width+"px",this._container.style.height=t.height+"px"},t.prototype.isCanvasRender=function(){return!1},t.prototype.setZIndex=function(t){this._zIndex=t,this._container&&(this._container.style.zIndex=t)},t.prototype.getMap=function(){return this.layer.getMap()},t.prototype.render=function(){this._container||this._createLayerContainer(),this._ec||this._createEcharts(),this._ec.setOption(this.layer._ecOptions,!1),this.layer.fire("layerload")},t.prototype._createLayerContainer=function(){var t=this._container=e.DomUtil.createEl("div");t.style.cssText="position:absolute;left:0px;top:0px;",this._zIndex&&(t.style.zIndex=this._zIndex),this._resetContainer(),("front"===this.layer.options.container?this.getMap()._panels.frontStatic:this.getMap()._panels.backStatic).appendChild(t)},t.prototype._createEcharts=function(){this._ec=n.init(this._container);var t=this.layer._ecOptions.series;t&&!t.coordinateSystem&&this._monitorSeries(t)},t.prototype._getE3CoordinateSystem=function(t){var o=function(t){this.map=t,this._mapOffset=[0,0]},i=this;return o.create=function(e){e.eachSeries(function(e){e.get("coordinateSystem")===i._coordSystemName&&(e.coordinateSystem=new o(t))})},o.getDimensionsInfo=function(){return["x","y"]},o.dimensions=["x","y"],e.Util.extend(o.prototype,{dimensions:["x","y"],setMapOffset:function(t){this._mapOffset=t},dataToPoint:function(t){var n=new e.Coordinate(t),o=this.map.coordinateToContainerPoint(n),i=this._mapOffset;return[o.x-i[0],o.y-i[1]]},pointToData:function(t){var e=this._mapOffset,n=this.map.containerPointToCoordinate({x:t[0]+e[0],y:t[1]+e[1]});return[n.x,n.y]},getViewRect:function(){var t=this.map.getSize();return new n.graphic.BoundingRect(0,0,t.width,t.height)},getRoamTransform:function(){return n.matrix.create()}}),o},t.prototype._monitorSeries=function(t){for(var e=t.length-1;e>=0;e--)t[e].coordinateSystem="maptalks3D",t[e].animation=!1},t}()),t.E4Layer=a,Object.defineProperty(t,"__esModule",{value:!0}),"undefined"!=typeof console&&console.log("maptalks.e4 v1.0.0")});